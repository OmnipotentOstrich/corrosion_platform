import{c as p,o as f,d as o,f as v,ak as r,aI as a,aJ as m,b,S as g,L as d,x as c,aN as y}from"./index-B_YfpHek.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const h={name:"ResourceAdd",data(){return{form:{name:"",description:"",type:"",category:"",tags:"",isPublic:!0},selectedFile:null,uploading:!1}},computed:{isFormValid(){return this.form.name&&this.form.type&&this.form.category&&this.selectedFile}},methods:{handleFileSelect(i){const e=i.target.files[0];e&&(this.selectedFile=e,this.form.name||(this.form.name=e.name.replace(/\.[^/.]+$/,"")))},formatFileSize(i){if(i===0)return"0 Bytes";const e=1024,u=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(i)/Math.log(e));return parseFloat((i/Math.pow(e,n)).toFixed(2))+" "+u[n]},async uploadResource(){if(!this.isFormValid){this.$message.warning("请填写必填字段并选择文件");return}this.uploading=!0;try{this.$message.info("正在上传资源，请稍候..."),await new Promise(i=>setTimeout(i,2e3)),this.$message.success("资源上传成功！"),this.resetForm(),this.$router.push("/dashboard/resources")}catch(i){console.error("上传失败:",i),this.$message.error("上传失败，请重试")}finally{this.uploading=!1}},resetForm(){this.form={name:"",description:"",type:"",category:"",tags:"",isPublic:!0},this.selectedFile=null,this.$refs.fileInput.value=""}}},V={class:"resource-add"},x={class:"add-form"},S={class:"form-group"},w={class:"form-group"},M={class:"form-row"},k={class:"form-group"},B={class:"form-group"},U={class:"form-group"},z={class:"file-upload"},N={key:0,class:"file-info"},P={class:"file-name"},_={class:"file-size"},q={class:"form-group"},C={class:"form-group"},I={class:"form-actions"},R=["disabled"];function T(i,e,u,n,t,l){return f(),p("div",V,[e[18]||(e[18]=o("div",{class:"page-header"},[o("h1",null,"添加资源"),o("p",null,"上传新的资源文件到平台")],-1)),o("div",x,[o("form",{onSubmit:e[8]||(e[8]=v((...s)=>l.uploadResource&&l.uploadResource(...s),["prevent"]))},[o("div",S,[e[9]||(e[9]=o("label",{for:"name"},"资源名称 *",-1)),r(o("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=s=>t.form.name=s),placeholder:"请输入资源名称",required:""},null,512),[[a,t.form.name]])]),o("div",w,[e[10]||(e[10]=o("label",{for:"description"},"资源描述",-1)),r(o("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=s=>t.form.description=s),placeholder:"请输入资源描述",rows:"3"},null,512),[[a,t.form.description]])]),o("div",M,[o("div",k,[e[12]||(e[12]=o("label",{for:"type"},"资源类型 *",-1)),r(o("select",{id:"type","onUpdate:modelValue":e[2]||(e[2]=s=>t.form.type=s),required:""},[...e[11]||(e[11]=[b('<option value="" data-v-b5022fb1>请选择类型</option><option value="document" data-v-b5022fb1>文档</option><option value="image" data-v-b5022fb1>图片</option><option value="video" data-v-b5022fb1>视频</option><option value="software" data-v-b5022fb1>软件</option><option value="template" data-v-b5022fb1>模板</option>',6)])],512),[[m,t.form.type]])]),o("div",B,[e[14]||(e[14]=o("label",{for:"category"},"资源分类 *",-1)),r(o("select",{id:"category","onUpdate:modelValue":e[3]||(e[3]=s=>t.form.category=s),required:""},[...e[13]||(e[13]=[b('<option value="" data-v-b5022fb1>请选择分类</option><option value="technical" data-v-b5022fb1>技术资料</option><option value="training" data-v-b5022fb1>培训材料</option><option value="standard" data-v-b5022fb1>标准规范</option><option value="tool" data-v-b5022fb1>工具软件</option>',5)])],512),[[m,t.form.category]])])]),o("div",U,[e[15]||(e[15]=o("label",{for:"file"},"选择文件 *",-1)),o("div",z,[o("input",{type:"file",id:"file",ref:"fileInput",onChange:e[4]||(e[4]=(...s)=>l.handleFileSelect&&l.handleFileSelect(...s)),required:""},null,544),t.selectedFile?(f(),p("div",N,[o("span",P,d(t.selectedFile.name),1),o("span",_,d(l.formatFileSize(t.selectedFile.size)),1)])):g("",!0)])]),o("div",q,[e[16]||(e[16]=o("label",{for:"tags"},"标签",-1)),r(o("input",{type:"text",id:"tags","onUpdate:modelValue":e[5]||(e[5]=s=>t.form.tags=s),placeholder:"请输入标签，用逗号分隔"},null,512),[[a,t.form.tags]])]),o("div",C,[o("label",null,[r(o("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>t.form.isPublic=s)},null,512),[[y,t.form.isPublic]]),e[17]||(e[17]=c(" 公开资源（其他用户可以下载） ",-1))])]),o("div",I,[o("button",{type:"button",class:"btn btn-outline",onClick:e[7]||(e[7]=(...s)=>l.resetForm&&l.resetForm(...s))}," 重置 "),o("button",{type:"submit",class:"btn btn-primary",disabled:!l.isFormValid||t.uploading},d(t.uploading?"上传中...":"上传资源"),9,R)])],32)])])}const E=F(h,[["render",T],["__scopeId","data-v-b5022fb1"]]);export{E as default};
