/* empty css             *//* empty css                   */import{r as d,M as k,O as B,C as T,c as l,o as i,d as s,ak as g,aI as P,aJ as $,al as L,S,H as D,I as E,an as _,B as c,a8 as f,aj as V,L as u,ax as Y}from"./index-B_YfpHek.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U={class:"enterprise-projects"},F={class:"filters"},H={class:"projects-list"},N={key:0,class:"empty-state"},z={class:"project-header"},J={class:"project-description"},O={class:"project-meta"},Q={class:"project-actions"},q=["onClick"],A=["onClick"],G={__name:"Projects",setup(K){const p=d(!1),n=d(""),o=d(""),v=d([]),y={active:"进行中",completed:"已完成",paused:"暂停",pending:"待开始"},x=t=>t?V(t).format("YYYY-MM-DD"):"-",h=k(()=>v.value.filter(t=>{const a=!n.value||t.name?.toLowerCase().includes(n.value.toLowerCase())||t.description?.toLowerCase().includes(n.value.toLowerCase()),r=!o.value||t.status===o.value;return a&&r})),m=async()=>{try{p.value=!0;const t={};n.value&&(t.search=n.value),o.value&&(t.status=o.value);const a=await _.get("/enterprises/projects/",{params:t}),r=a.data.results||a.data||[];v.value=r.map(e=>({id:e.id,name:e.name||e.title||"未命名项目",description:e.description||"暂无描述",manager:e.manager_name||e.manager||"-",deadline:x(e.end_date||e.deadline),status:e.status||"active",statusText:y[e.status]||e.status,...e}))}catch(t){console.error("加载项目列表失败:",t),c.error("加载项目列表失败"),v.value=[]}finally{p.value=!1}},w=async()=>{try{const{value:t}=await f.prompt("请输入项目名称","新建项目",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.+/,inputErrorMessage:"项目名称不能为空"});await _.post("/enterprises/projects/",{name:t,description:"",status:"active"}),c.success(`项目 ${t} 创建成功`),m()}catch(t){t!=="cancel"&&(console.error("创建项目失败:",t),c.error("创建项目失败"))}},C=t=>{f.alert(`
      <div style="text-align: left;">
        <p><strong>描述：</strong>${t.description}</p>
        <p><strong>负责人：</strong>${t.manager}</p>
        <p><strong>截止日期：</strong>${t.deadline}</p>
        <p><strong>状态：</strong>${t.statusText}</p>
      </div>
    `,t.name,{dangerouslyUseHTMLString:!0,confirmButtonText:"关闭"})},M=async t=>{try{const{value:a}=await f.prompt(`编辑项目 - ${t.name}`,"编辑项目",{confirmButtonText:"保存",cancelButtonText:"取消",inputValue:t.name,inputPattern:/.+/,inputErrorMessage:"项目名称不能为空"});await _.put(`/enterprises/projects/${t.id}/`,{...t,name:a}),c.success("项目信息已更新"),m()}catch(a){a!=="cancel"&&(console.error("更新项目失败:",a),c.error("更新项目失败"))}};return B([n,o],()=>{}),T(()=>{m()}),(t,a)=>{const r=L;return i(),l("div",U,[s("div",{class:"page-header"},[a[2]||(a[2]=s("h1",null,"项目管理",-1)),s("div",{class:"header-actions"},[s("button",{class:"btn btn-primary",onClick:w}," 新建项目 ")])]),s("div",F,[g(s("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"搜索项目...",class:"search-input"},null,512),[[P,n.value]]),g(s("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),class:"filter-select"},[...a[3]||(a[3]=[s("option",{value:""},"全部状态",-1),s("option",{value:"active"},"进行中",-1),s("option",{value:"completed"},"已完成",-1),s("option",{value:"paused"},"暂停",-1)])],512),[[$,o.value]])]),g((i(),l("div",H,[h.value.length===0?(i(),l("div",N,[...a[4]||(a[4]=[s("p",null,"暂无项目数据",-1)])])):S("",!0),(i(!0),l(D,null,E(h.value,e=>(i(),l("div",{key:e.id,class:"project-card"},[s("div",z,[s("h3",null,u(e.name),1),s("span",{class:Y(["status",e.status])},u(e.statusText),3)]),s("p",J,u(e.description),1),s("div",O,[s("span",null,"负责人: "+u(e.manager),1),s("span",null,"截止日期: "+u(e.deadline),1)]),s("div",Q,[s("button",{class:"btn btn-sm btn-outline",onClick:b=>C(e)},"查看详情",8,q),s("button",{class:"btn btn-sm btn-primary",onClick:b=>M(e)},"编辑",8,A)])]))),128))])),[[r,p.value]])])}}},j=I(G,[["__scopeId","data-v-5f19cc1a"]]);export{j as default};
