import{r as d,O as C,C as V,c as o,o as l,d as t,e as k,w as h,Q as z,ak as _,aI as N,aJ as f,b as B,S as D,H as I,I as L,an as g,B as p,x as m,L as n,ax as M}from"./index-B_YfpHek.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"info-plaza"},U={class:"page-header"},$={class:"header-actions"},E={class:"filters"},F={key:0,class:"loading"},Q={key:1,class:"info-list"},H={key:0,class:"empty-state"},J={class:"info-header"},O={class:"category"},j={class:"info-summary"},q={class:"info-meta"},A={class:"info-actions"},G=["onClick"],K={key:0},P={key:1},R={__name:"index",setup(W){const c=d(!1),i=d(""),r=d(""),u=d("-published_at"),v=d([]),y=async()=>{try{c.value=!0;const a={ordering:u.value};i.value&&(a.search=i.value),r.value&&(a.post_type=r.value);const e=await g.get("/info-plaza/posts/",{params:a});v.value=e.data.results||e.data}catch(a){console.error("加载信息失败:",a),p.error("加载信息失败，请稍后重试")}finally{c.value=!1}},x=async a=>{try{(await g.post(`/info-plaza/posts/${a.id}/like/`)).data.liked?(a.is_liked=!0,a.like_count+=1,p.success("点赞成功")):(a.is_liked=!1,a.like_count-=1,p.success("已取消点赞"))}catch(e){console.error("点赞失败:",e),p.error("操作失败，请重试")}},w=a=>a?new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}):"";return C([i,r,u],()=>{y()}),V(()=>{y()}),(a,e)=>{const b=z("router-link");return l(),o("div",T,[t("div",U,[e[4]||(e[4]=t("h1",null,"信息广场",-1)),t("div",$,[k(b,{to:"/dashboard/info-plaza/publish",class:"btn btn-primary"},{default:h(()=>[...e[3]||(e[3]=[m(" 发布信息 ",-1)])]),_:1})])]),t("div",E,[_(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),placeholder:"搜索信息...",class:"search-input"},null,512),[[N,i.value]]),_(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),class:"filter-select"},[...e[5]||(e[5]=[B('<option value="" data-v-25e7082b>全部类型</option><option value="supply" data-v-25e7082b>供应信息</option><option value="demand" data-v-25e7082b>需求信息</option><option value="recruitment" data-v-25e7082b>招聘信息</option><option value="tender" data-v-25e7082b>招标信息</option><option value="technology" data-v-25e7082b>技术文章</option><option value="news" data-v-25e7082b>行业资讯</option><option value="other" data-v-25e7082b>其他</option>',8)])],512),[[f,r.value]]),_(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>u.value=s),class:"filter-select"},[...e[6]||(e[6]=[t("option",{value:"-published_at"},"最新发布",-1),t("option",{value:"-like_count"},"最受欢迎",-1),t("option",{value:"-view_count"},"最多浏览",-1)])],512),[[f,u.value]])]),c.value?(l(),o("div",F,"加载中...")):(l(),o("div",Q,[v.value.length===0?(l(),o("div",H,[...e[7]||(e[7]=[t("p",null,"暂无信息",-1)])])):D("",!0),(l(!0),o(I,null,L(v.value,s=>(l(),o("div",{key:s.id,class:"info-card"},[t("div",J,[t("h3",null,n(s.title),1),t("span",O,n(s.post_type_display),1)]),t("p",j,n(s.summary||"暂无摘要"),1),t("div",q,[t("span",null,"发布者: "+n(s.author_name),1),t("span",null,"发布时间: "+n(w(s.published_at)),1),t("span",null,"浏览: "+n(s.view_count),1),t("span",null,"点赞: "+n(s.like_count),1)]),t("div",A,[k(b,{to:`/dashboard/info-plaza/detail/${s.id}`,class:"btn btn-sm btn-primary"},{default:h(()=>[...e[8]||(e[8]=[m(" 查看详情 ",-1)])]),_:1},8,["to"]),t("button",{class:M(["btn","btn-sm",s.is_liked?"btn-liked":"btn-outline"]),onClick:X=>x(s)},[s.is_liked?(l(),o("span",K,"❤️ 已点赞")):(l(),o("span",P,"🤍 点赞")),m(" ("+n(s.like_count)+") ",1)],10,G)])]))),128))]))])}}},ee=S(R,[["__scopeId","data-v-25e7082b"]]);export{ee as default};
